<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script>
    function sendForm(formId) {
      document.getElementById(formId).submit();
    }
  </script>

  <title>Catalog page</title>
</head>
<body>
<div class="container">
  <div th:insert="header"></div>
  <div class="row mx-3 pt-4 gx-5">
    <div class="col-9">
      <div class="row">
        <div class="col fs-5">
          allProducts
        </div>
        <div class="col-md-auto">
          <form id="sortForm" action="${pageContext.request.contextPath}/main/catalog">
            <label for="sortSelect" class="fs-5">sortBy</label>
            <select name="options" id="sortSelect" onchange="sendForm('sortForm')">
              <option id="option1" th:if="${session.get('sortOption') == 'byNameAZ'}" th:attr="selected"
              value="byNameAZ">byNameAZ</option>
              <option id="option2" th:if="${session.get('sortOption') == 'byNameZA'}" th:attr="selected"
              value="byNameZA">byNameZA</option>
              <option id="option3" th:if="${session.get('sortOption') == 'priceHighLow'}" th:attr="selected"
              value="priceHighLow">byPriceHL</option>
              <option id="option4" th:if="${session.get('sortOption') == 'priceLowHigh'}" th:attr="selected"
              value="priceLowHigh">byPriceLH</option>
              <option id="option5" th:if="${session.get('sortOption') == 'newest'}" th:attr="selected"
              value="newest">byNewest</option>
            </select>
          </form>
        </div>
      </div>
      <div class="row">
        <div class="col">
          <table class="table">
            <thead>
            <tr>
              <th scope="col">#</th>
              <th scope="col">productName</th>
              <th scope="col">price</th>
              <th scope="col">creationDate</th>
              <th scope="col">properties</th>
              <th scope="col"></th>
            </tr>
            </thead>
            <tbody>
<!--            <c:set var="i" value="${(requestScope.currentPage - 1) * 10 + 1}"/>-->
            <div th:each="product : ${session.get('products')}">
              <tr>
                <th scope="row">1</th>
<!--                <c:set var="i" value="${i+1}"/>-->
                <td th:text="${product.name}"/>
                <td th:text="${product.price}"/>
                <td th:text="${product.creationDate}"/>
                <td th:each="property : ${product.properties}">
                  <p th:text="${property.key + ':' + property.value}">
                    <br>
                </td>
                <td>
                  <form action="${pageContext.request.contextPath}/main/addToCart" method="post">
                    <input type="hidden" name="productId" value="${product.id}"/>
                    <button class="btn btn-outline-dark btn-sm">
                      addToCart
                    </button>
                  </form>
                </td>
              </tr>
            </div>
            </tbody>
          </table>

<!--          <div class="row">-->
<!--            <div class="col-md-auto">-->
<!--              <%&#45;&#45;For displaying Previous link except for the 1st page &#45;&#45;%>-->
<!--              <nav aria-label="Page navigation">-->
<!--                <ul class="pagination">-->
<!--                  <c:if test="${requestScope.currentPage != 1}">-->
<!--                    <li>-->
<!--                      <a class="page-link"-->
<!--                         href="${pageContext.request.contextPath}/main/catalog?page=${requestScope.currentPage - 1}"><fmt:message key="previous"/></a>-->
<!--                    </li>-->
<!--                  </c:if>-->

<!--                  <%&#45;&#45;For displaying Page numbers.-->
<!--                  The when condition does not display a link for the current page&#45;&#45;%>-->
<!--                  <c:forEach begin="1" end="${requestScope.numberOfPages}" var="i">-->
<!--                    <c:choose>-->
<!--                      <c:when test="${requestScope.currentPage eq i}">-->
<!--                        <li class="page-item active">-->
<!--                          <a class="page-link" aria-disabled="true">${i}</a>-->
<!--                        </li>-->
<!--                      </c:when>-->
<!--                      <c:otherwise>-->
<!--                        <li>-->
<!--                          <a class="page-link"-->
<!--                             href="${pageContext.request.contextPath}/main/catalog?page=${i}">${i}</a>-->
<!--                        </li>-->
<!--                      </c:otherwise>-->
<!--                    </c:choose>-->
<!--                  </c:forEach>-->

<!--                  <%&#45;&#45;For displaying Next link &#45;&#45;%>-->
<!--                  <c:if test="${requestScope.currentPage lt requestScope.numberOfPages}">-->
<!--                    <td>-->
<!--                      <a class="page-link"-->
<!--                         href="${pageContext.request.contextPath}/main/catalog?page=${requestScope.currentPage + 1}"><fmt:message key="next"/></a>-->
<!--                    </td>-->
<!--                  </c:if>-->
<!--                </ul>-->
<!--              </nav>-->
<!--            </div>-->
<!--          </div>-->
        </div>
      </div>
    </div>
    <div class="col-3">
      <div class="row">
        <div class="col fs-5">
          Properties:
        </div>
      </div>
      <div class="row pt-5">
        <div class="col mt-3" style="height: 600px; overflow-y: scroll;">
          <form id="formProperties" action="${pageContext.request.contextPath}/main/catalog">
            <input type="hidden" name="action" value="selectByProperties">
<!--            <c:set var="j" value="${1}"/>-->
<!--            <c:forEach items="${sessionScope.productProperties}" var="property">-->
<!--              <fieldset>-->
<!--                <legend class="fs-5">${property.key}:</legend>-->
<!--                <c:forEach items="${property.value}" var="value">-->
<!--                  <input class="form-check-input" type="checkbox" id="${j}" name="${property.key}"-->
<!--                         value="${value}"/>-->
<!--                  <label for="${j}">${value}</label>-->
<!--                </c:forEach>-->
<!--              </fieldset>-->
<!--              <br>-->
<!--            </c:forEach>-->
<!--            <c:set var="j" value="${j+1}"/>-->
<!--            <div class="row">-->
<!--              <div class="col gx-1">-->
<!--                <label for="priceFrom" class="form-label"><fmt:message key="localPriceFrom"/></label>-->
<!--                <input type="number" name="priceFrom" class="form-control" id="priceFrom" min="0"-->
<!--                       placeholder="<fmt:message key="localPriceFrom"/>">-->
<!--              </div>-->
<!--              <div class="col">-->
<!--                <label for="priceTo" class="form-label"><fmt:message key="localPriceTo"/></label>-->
<!--                <input type="number" name="priceTo" class="form-control" id="priceTo" min="0"-->
<!--                       placeholder="<fmt:message key="localPriceTo"/>">-->
<!--              </div>-->
<!--            </div>-->
          </form>
        </div>
      </div>
      <div class="row justify-content-center">
        <div class="col-md-auto fs-6 pt-5">
          <button form="formProperties" class="btn btn-outline-dark">
            submitSelect
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
</body>
</html>